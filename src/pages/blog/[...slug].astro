---
import '../../styles/global.css';
import Header from '../../components/Header.astro';
import Footer from '../../components/Footer.astro';
import { getCollection } from 'astro:content';

export async function getStaticPaths() {
  const posts = await getCollection('blog');
  return posts.map((post) => ({
    params: { slug: post.slug },
    props: { post },
  }));
}

const { post } = Astro.props;
const { Content } = await post.render();

const formattedDate = post.data.date.toLocaleDateString('en-US', {
  year: 'numeric',
  month: 'long',
  day: 'numeric',
});
---

<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="description" content={post.data.description} />

    <!-- Open Graph -->
    <meta property="og:title" content={`${post.data.title} | Franzke Technologies`} />
    <meta property="og:description" content={post.data.description} />
    <meta property="og:type" content="article" />
    <meta property="og:image" content="/og.png" />

    <link rel="icon" type="image/x-icon" href="/favicon.ico" />
    <title>{post.data.title} | Franzke Technologies</title>
  </head>
  <body class="flex min-h-screen flex-col bg-white text-slate-900">
    <!-- Animated background shapes -->
    <div class="bg-shapes-container">
      <div class="bg-shape bg-shape-1"></div>
      <div class="bg-shape bg-shape-2"></div>
      <div class="bg-shape bg-shape-3"></div>
      <div class="bg-shape bg-shape-4"></div>
    </div>

    <div class="hero-section min-h-screen">
      <Header variant="dark" />

      <!-- Decorative elements -->
      <div class="absolute right-0 top-1/4 h-64 w-64 rounded-full bg-electric-500/10 blur-3xl z-[1]"></div>
      <div class="absolute left-1/4 top-1/2 h-48 w-48 rounded-full bg-purple-500/10 blur-3xl z-[1]"></div>

      <article class="relative z-[2] py-16 sm:py-20">
        <div class="mx-auto max-w-3xl px-4 sm:px-6">
          <!-- Back link -->
          <a
            href="/blog"
            class="inline-flex items-center gap-2 text-sm text-slate-400 hover:text-electric-400 transition-colors"
          >
            <svg class="h-4 w-4" fill="none" viewBox="0 0 24 24" stroke="currentColor">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7" />
            </svg>
            Back to blog
          </a>

          <!-- Article header -->
          <header class="mt-8 animate-on-scroll slide-from-bottom">
            <time datetime={post.data.date.toISOString()} class="text-sm text-electric-400">
              {formattedDate}
            </time>
            <h1 class="mt-2 text-3xl font-bold text-white sm:text-4xl lg:text-5xl">
              {post.data.title}
            </h1>
            {post.data.tags && post.data.tags.length > 0 && (
              <div class="mt-4 flex flex-wrap gap-2">
                {post.data.tags.map((tag) => (
                  <span class="rounded-full bg-electric-500/20 px-3 py-1 text-xs font-medium text-electric-400">
                    {tag}
                  </span>
                ))}
              </div>
            )}
          </header>

          <!-- Article content -->
          <div class="animate-on-scroll slide-from-bottom mt-10 service-card rounded-2xl p-[2px]">
            <div class="service-card-inner rounded-2xl bg-navy-900/80 backdrop-blur-sm p-8 sm:p-10">
              <div class="prose prose-invert max-w-none prose-headings:text-white prose-headings:font-bold prose-p:text-slate-300 prose-a:text-electric-400 prose-a:no-underline hover:prose-a:underline prose-strong:text-white prose-code:text-electric-300 prose-code:bg-navy-800/50 prose-code:px-1.5 prose-code:py-0.5 prose-code:rounded prose-code:before:content-none prose-code:after:content-none prose-pre:bg-navy-800/80 prose-pre:border prose-pre:border-white/10 prose-blockquote:border-electric-500 prose-blockquote:text-slate-300 prose-li:text-slate-300 prose-ul:text-slate-300 prose-ol:text-slate-300">
                <Content />
              </div>
            </div>
          </div>

          <!-- Footer -->
          <footer class="animate-on-scroll slide-from-bottom mt-12 rounded-2xl bg-navy-800/60 backdrop-blur-sm border border-white/10 p-6 text-center">
            <p class="text-slate-300">
              Have questions or thoughts?{' '}
              <a href="/contact" class="font-medium text-electric-400 hover:text-electric-300 transition-colors">
                Get in touch
              </a>
            </p>
          </footer>
        </div>
      </article>

      <!-- Related posts CTA -->
      <section class="relative z-[2] py-16 sm:py-20">
        <div class="mx-auto max-w-6xl px-4 text-center sm:px-6">
          <div class="animate-on-scroll slide-from-bottom">
            <h2 class="text-3xl font-bold text-white sm:text-4xl">Read More</h2>
            <p class="mt-4 text-lg text-slate-300">
              Explore more thoughts on AI, architecture, and shipping software.
            </p>
            <a
              href="/blog"
              class="mt-8 inline-block rounded-full border-2 border-electric-500 bg-transparent px-8 py-3 text-base font-medium text-white transition-all hover:bg-electric-500"
            >
              View all posts
            </a>
          </div>
        </div>
      </section>
    </div>

    <Footer />

    <script>
      const observer = new IntersectionObserver(
        (entries) => {
          entries.forEach((entry) => {
            if (entry.isIntersecting) {
              entry.target.classList.add('is-visible');
            }
          });
        },
        {
          threshold: 0.1,
          rootMargin: '0px 0px -50px 0px',
        }
      );

      document.querySelectorAll('.animate-on-scroll').forEach((el) => {
        observer.observe(el);
      });
    </script>
  </body>
</html>
