---
import '../../styles/global.css';
import Header from '../../components/Header.astro';
import Footer from '../../components/Footer.astro';
import BlogPostPreview from '../../components/BlogPostPreview.astro';
import { getCollection } from 'astro:content';

const allPosts = await getCollection('blog');
const sortedPosts = allPosts.sort((a, b) => b.data.date.valueOf() - a.data.date.valueOf());
---

<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="description" content="Thoughts on AI, architecture, and shipping software." />

    <!-- Open Graph -->
    <meta property="og:title" content="Blog | Franzke Technologies" />
    <meta property="og:description" content="Thoughts on AI, architecture, and shipping software." />
    <meta property="og:type" content="website" />
    <meta property="og:image" content="/og.png" />

    <link rel="icon" type="image/x-icon" href="/favicon.ico" />
    <title>Blog | Franzke Technologies</title>
  </head>
  <body class="flex min-h-screen flex-col bg-white text-slate-900">
    <!-- Animated background shapes -->
    <div class="bg-shapes-container">
      <div class="bg-shape bg-shape-1"></div>
      <div class="bg-shape bg-shape-2"></div>
      <div class="bg-shape bg-shape-3"></div>
      <div class="bg-shape bg-shape-4"></div>
    </div>

    <div class="hero-section min-h-screen">
      <Header variant="dark" />

      <!-- Decorative elements -->
      <div class="absolute right-0 top-1/4 h-64 w-64 rounded-full bg-electric-500/10 blur-3xl z-[1]"></div>
      <div class="absolute left-1/4 top-1/2 h-48 w-48 rounded-full bg-purple-500/10 blur-3xl z-[1]"></div>

      <!-- Hero -->
      <section class="relative z-[2] py-16 sm:py-24">
        <div class="mx-auto max-w-6xl px-4 sm:px-6">
          <div class="animate-on-scroll slide-from-bottom text-center">
            <p class="section-label">From the blog</p>
            <h1 class="mt-4 text-4xl font-bold text-white sm:text-5xl lg:text-6xl">Blog</h1>
            <p class="mx-auto mt-6 max-w-2xl text-lg text-slate-300">
              Thoughts on AI, architecture, and shipping software.
            </p>
          </div>
        </div>
      </section>

      <!-- Posts List -->
      <section class="relative z-[2] py-8 sm:py-12">
        <div class="mx-auto max-w-3xl px-4 sm:px-6">
          {sortedPosts.length > 0 ? (
            <div class="animate-on-scroll slide-from-bottom rounded-2xl bg-navy-800/60 backdrop-blur-sm border border-white/10 p-6">
              {sortedPosts.map((post) => (
                <BlogPostPreview
                  title={post.data.title}
                  date={post.data.date}
                  description={post.data.description}
                  slug={post.slug}
                  variant="dark"
                />
              ))}
            </div>
          ) : (
            <div class="animate-on-scroll slide-from-bottom service-card rounded-2xl p-[2px]">
              <div class="service-card-inner rounded-2xl bg-navy-900/80 backdrop-blur-sm p-12 text-center">
                <p class="text-slate-300">No posts yet. Check back soon!</p>
              </div>
            </div>
          )}
        </div>
      </section>

      <!-- CTA -->
      <section class="relative z-[2] py-16 sm:py-20">
        <div class="mx-auto max-w-6xl px-4 text-center sm:px-6">
          <div class="animate-on-scroll slide-from-bottom">
            <h2 class="text-3xl font-bold text-white sm:text-4xl">Want to stay updated?</h2>
            <p class="mt-4 text-lg text-slate-300">
              Have a question or want to discuss a topic?
            </p>
            <a
              href="/contact"
              class="mt-8 inline-block rounded-full border-2 border-electric-500 bg-transparent px-8 py-3 text-base font-medium text-white transition-all hover:bg-electric-500"
            >
              Get in touch
            </a>
          </div>
        </div>
      </section>
    </div>

    <Footer />

    <script>
      const observer = new IntersectionObserver(
        (entries) => {
          entries.forEach((entry) => {
            if (entry.isIntersecting) {
              entry.target.classList.add('is-visible');
            }
          });
        },
        {
          threshold: 0.1,
          rootMargin: '0px 0px -50px 0px',
        }
      );

      document.querySelectorAll('.animate-on-scroll').forEach((el) => {
        observer.observe(el);
      });
    </script>
  </body>
</html>
